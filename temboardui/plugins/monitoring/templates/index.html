{% extends ../../../templates/base.html %}

{% block title %}[{{instance.hostname}}:{{instance.pg_port}}] - Monitoring{% end %}

{% block content %}
<div class="modal fade" id="Modal" tabindex="-1" role="dialog" aria-labelledby="ModalLabel">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title" id="ModalLabel"></h4>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
      </div>
      <div class="modal-body" id="ModalBody">
        <img id="imageModal" width="100%"/>
      </div>
      <div class="modal-footer" id="ModalFooter">
        <button type="button" class="btn btn-outline-secondary" data-dismiss="modal">Cancel</button>
      </div>
    </div>
  </div>
</div>
<div class="row form-group">
  <div class="col">
    <div id="daterange">
      <i class="fa fa-calendar"></i>
      <span></span>
      <i class="caret"></i>
    </div>
  </div>
</div>

<div id="charts-container">
  <div class="row">
    <div class="col-4">
      <span class="text-muted text-uppercase">System</span>
      <ul class="list-unstyled">
        <li v-for="graph in graphs" v-if="graph.category == 'system'">
          <div class="form-check">
            <input type="checkbox" v-model="graph.visible" :id="'checkbox' + graph.id">
            <label class="form-check-label" :for="'checkbox' + graph.id">
              {{! graph.title }}
            </label>
          </div>
        </li>
      </ul>
    </div>
    <div class="col-4">
      <span class="text-muted text-uppercase">Postgres</span>
      <ul class="list-unstyled">
        <li v-for="(graph, index) in graphs" v-if="graph.category == 'postgres'">
          <div class="form-check">
            <input type="checkbox" v-model="graph.visible" :id="'checkbox' + graph.id">
            <label class="form-check-label" :for="'checkbox' + graph.id">
              {{! graph.title }}
            </label>
          </div>
        </li>
      </ul>
    </div>
    <div class="col-4">
    </div>
  </div>
  <div class="card w-100 mb-2" v-for="graph in graphs" v-if="graph.visible">
    <div class="card-header">
      {{! graph.title }}
    </div>
    <div class="card-body">
      <div :id="'info' + graph.id"></div>
      <div :id="'legend' + graph.id" class="legend-chart"><div class="row"><div class="col-md-4 col-md-offset-4"><div class="progress"><div class="progress-bar progress-bar-striped" style="width: 100%;">Loading, please wait ...</div></div></div></div></div>
      <monitoring-chart :graph="graph" :id="'chart' + graph.id"></monitoring-chart>
      <div :id="'visibility' + graph.id" class="visibility-chart"></div>
    </div>
  </div>
</div>

<script src="/js/vue.min.js"></script>
<script src="/js/dygraph.min.js"></script>
<script src="/js/moment.min.js"></script>
<script src="/js/daterangepicker.js"></script>
<script src="/js/monitoring/temboard.monitoring.js"></script>
<script>
var apiUrl = "/server/{{instance.agent_address}}/{{instance.agent_port}}/monitoring/data"
</script>

{% end %}
